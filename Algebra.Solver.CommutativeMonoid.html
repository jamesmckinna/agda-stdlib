<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Algebra.Solver.CommutativeMonoid</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Solver for equations in commutative monoids</a>
<a id="153" class="Comment">--</a>
<a id="156" class="Comment">-- Adapted from Algebra.Solver.Monoid</a>
<a id="194" class="Comment">------------------------------------------------------------------------</a>

<a id="268" class="Symbol">{-#</a> <a id="272" class="Keyword">OPTIONS</a> <a id="280" class="Pragma">--cubical-compatible</a> <a id="301" class="Pragma">--safe</a> <a id="308" class="Symbol">#-}</a>

<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Algebra.html" class="Module">Algebra</a>

<a id="334" class="Keyword">module</a> <a id="341" href="Algebra.Solver.CommutativeMonoid.html" class="Module">Algebra.Solver.CommutativeMonoid</a> <a id="374" class="Symbol">{</a><a id="375" href="Algebra.Solver.CommutativeMonoid.html#375" class="Bound">m₁</a> <a id="378" href="Algebra.Solver.CommutativeMonoid.html#378" class="Bound">m₂</a><a id="380" class="Symbol">}</a> <a id="382" class="Symbol">(</a><a id="383" href="Algebra.Solver.CommutativeMonoid.html#383" class="Bound">M</a> <a id="385" class="Symbol">:</a> <a id="387" href="Algebra.Bundles.html#6604" class="Record">CommutativeMonoid</a> <a id="405" href="Algebra.Solver.CommutativeMonoid.html#375" class="Bound">m₁</a> <a id="408" href="Algebra.Solver.CommutativeMonoid.html#378" class="Bound">m₂</a><a id="410" class="Symbol">)</a> <a id="412" class="Keyword">where</a>

<a id="419" class="Keyword">open</a> <a id="424" class="Keyword">import</a> <a id="431" href="Data.Fin.Base.html" class="Module">Data.Fin.Base</a> <a id="445" class="Keyword">using</a> <a id="451" class="Symbol">(</a><a id="452" href="Data.Fin.Base.html#1312" class="Datatype">Fin</a><a id="455" class="Symbol">;</a> <a id="457" href="Data.Fin.Base.html#1334" class="InductiveConstructor">zero</a><a id="461" class="Symbol">;</a> <a id="463" href="Data.Fin.Base.html#1355" class="InductiveConstructor">suc</a><a id="466" class="Symbol">)</a>
<a id="468" class="Keyword">open</a> <a id="473" class="Keyword">import</a> <a id="480" href="Data.Maybe.Base.html" class="Module">Data.Maybe.Base</a> <a id="496" class="Symbol">as</a> <a id="499" class="Module">Maybe</a>
  <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a><a id="519" class="Symbol">;</a> <a id="521" href="Data.Maybe.Base.html#1241" class="Function">decToMaybe</a><a id="531" class="Symbol">;</a> <a id="533" href="Data.Maybe.Base.html#1847" class="Function">From-just</a><a id="542" class="Symbol">;</a> <a id="544" href="Data.Maybe.Base.html#1935" class="Function">from-just</a><a id="553" class="Symbol">)</a>
<a id="555" class="Keyword">open</a> <a id="560" class="Keyword">import</a> <a id="567" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="576" class="Symbol">as</a> <a id="579" class="Module">ℕ</a> <a id="581" class="Keyword">using</a> <a id="587" class="Symbol">(</a><a id="588" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="589" class="Symbol">;</a> <a id="591" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a><a id="595" class="Symbol">;</a> <a id="597" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a><a id="600" class="Symbol">;</a> <a id="602" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">_+_</a><a id="605" class="Symbol">)</a>
<a id="607" class="Keyword">open</a> <a id="612" class="Keyword">import</a> <a id="619" href="Data.Nat.GeneralisedArithmetic.html" class="Module">Data.Nat.GeneralisedArithmetic</a> <a id="650" class="Keyword">using</a> <a id="656" class="Symbol">(</a><a id="657" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a><a id="661" class="Symbol">)</a>
<a id="663" class="Keyword">open</a> <a id="668" class="Keyword">import</a> <a id="675" href="Data.Product.Base.html" class="Module">Data.Product.Base</a> <a id="693" class="Keyword">using</a> <a id="699" class="Symbol">(</a><a id="700" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="703" class="Symbol">;</a> <a id="705" href="Data.Product.Base.html#3109" class="Function">uncurry</a><a id="712" class="Symbol">)</a>
<a id="714" class="Keyword">open</a> <a id="719" class="Keyword">import</a> <a id="726" href="Data.Vec.Base.html" class="Module">Data.Vec.Base</a> <a id="740" class="Keyword">using</a> <a id="746" class="Symbol">(</a><a id="747" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a><a id="750" class="Symbol">;</a> <a id="752" href="Data.Vec.Base.html#1122" class="InductiveConstructor">[]</a><a id="754" class="Symbol">;</a> <a id="756" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">_∷_</a><a id="759" class="Symbol">;</a> <a id="761" href="Data.Vec.Base.html#1643" class="Function">lookup</a><a id="767" class="Symbol">;</a> <a id="769" href="Data.Vec.Base.html#6404" class="Function">replicate</a><a id="778" class="Symbol">)</a>

<a id="781" class="Keyword">open</a> <a id="786" class="Keyword">import</a> <a id="793" href="Function.Base.html" class="Module">Function.Base</a> <a id="807" class="Keyword">using</a> <a id="813" class="Symbol">(</a><a id="814" href="Function.Base.html#1115" class="Function Operator">_∘_</a><a id="817" class="Symbol">)</a>

<a id="820" class="Keyword">import</a> <a id="827" href="Relation.Binary.Reasoning.Setoid.html" class="Module">Relation.Binary.Reasoning.Setoid</a> <a id="860" class="Symbol">as</a> <a id="863" class="Module">EqReasoning</a>
<a id="875" class="Keyword">import</a> <a id="882" href="Relation.Binary.Reflection.html" class="Module">Relation.Binary.Reflection</a> <a id="909" class="Symbol">as</a> <a id="912" class="Module">Reflection</a>
<a id="923" class="Keyword">import</a> <a id="930" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="957" class="Symbol">as</a> <a id="960" class="Module">Dec</a>
<a id="964" class="Keyword">import</a> <a id="971" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Data.Vec.Relation.Binary.Pointwise.Inductive</a> <a id="1016" class="Symbol">as</a> <a id="1019" class="Module">Pointwise</a>

<a id="1030" class="Keyword">open</a> <a id="1035" class="Keyword">import</a> <a id="1042" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="1085" class="Symbol">as</a> <a id="1088" class="Module">P</a> <a id="1090" class="Keyword">using</a> <a id="1096" class="Symbol">(</a><a id="1097" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="1100" class="Symbol">)</a>
<a id="1102" class="Keyword">open</a> <a id="1107" class="Keyword">import</a> <a id="1114" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a> <a id="1141" class="Keyword">using</a> <a id="1147" class="Symbol">(</a><a id="1148" href="Relation.Nullary.Decidable.Core.html#1490" class="Record">Dec</a><a id="1151" class="Symbol">)</a>

<a id="1154" class="Keyword">open</a> <a id="1159" href="Algebra.Bundles.html#6604" class="Module">CommutativeMonoid</a> <a id="1177" href="Algebra.Solver.CommutativeMonoid.html#383" class="Bound">M</a>
<a id="1179" class="Keyword">open</a> <a id="1184" href="Relation.Binary.Reasoning.Setoid.html" class="Module">EqReasoning</a> <a id="1196" href="Algebra.Structures.html#1390" class="Function">setoid</a>

<a id="1204" class="Comment">------------------------------------------------------------------------</a>
<a id="1277" class="Comment">-- Monoid expressions</a>

<a id="1300" class="Comment">-- There is one constructor for every operation, plus one for</a>
<a id="1362" class="Comment">-- variables; there may be at most n variables.</a>

<a id="1411" class="Keyword">infixr</a> <a id="1418" class="Number">5</a> <a id="1420" href="Algebra.Solver.CommutativeMonoid.html#1509" class="InductiveConstructor Operator">_⊕_</a>
<a id="1424" class="Keyword">infixr</a> <a id="1431" class="Number">10</a> <a id="1434" href="Algebra.Solver.CommutativeMonoid.html#2484" class="Function Operator">_•_</a>

<a id="1439" class="Keyword">data</a> <a id="Expr"></a><a id="1444" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="1449" class="Symbol">(</a><a id="1450" href="Algebra.Solver.CommutativeMonoid.html#1450" class="Bound">n</a> <a id="1452" class="Symbol">:</a> <a id="1454" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a><a id="1455" class="Symbol">)</a> <a id="1457" class="Symbol">:</a> <a id="1459" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1463" class="Keyword">where</a>
  <a id="Expr.var"></a><a id="1471" href="Algebra.Solver.CommutativeMonoid.html#1471" class="InductiveConstructor">var</a> <a id="1475" class="Symbol">:</a> <a id="1477" href="Data.Fin.Base.html#1312" class="Datatype">Fin</a> <a id="1481" href="Algebra.Solver.CommutativeMonoid.html#1450" class="Bound">n</a> <a id="1483" class="Symbol">→</a> <a id="1485" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="1490" href="Algebra.Solver.CommutativeMonoid.html#1450" class="Bound">n</a>
  <a id="Expr.id"></a><a id="1494" href="Algebra.Solver.CommutativeMonoid.html#1494" class="InductiveConstructor">id</a>  <a id="1498" class="Symbol">:</a> <a id="1500" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="1505" href="Algebra.Solver.CommutativeMonoid.html#1450" class="Bound">n</a>
  <a id="Expr._⊕_"></a><a id="1509" href="Algebra.Solver.CommutativeMonoid.html#1509" class="InductiveConstructor Operator">_⊕_</a> <a id="1513" class="Symbol">:</a> <a id="1515" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="1520" href="Algebra.Solver.CommutativeMonoid.html#1450" class="Bound">n</a> <a id="1522" class="Symbol">→</a> <a id="1524" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="1529" href="Algebra.Solver.CommutativeMonoid.html#1450" class="Bound">n</a> <a id="1531" class="Symbol">→</a> <a id="1533" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="1538" href="Algebra.Solver.CommutativeMonoid.html#1450" class="Bound">n</a>

<a id="1541" class="Comment">-- An environment contains one value for every variable.</a>

<a id="Env"></a><a id="1599" href="Algebra.Solver.CommutativeMonoid.html#1599" class="Function">Env</a> <a id="1603" class="Symbol">:</a> <a id="1605" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="1607" class="Symbol">→</a> <a id="1609" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="1613" class="Symbol">_</a>
<a id="1615" href="Algebra.Solver.CommutativeMonoid.html#1599" class="Function">Env</a> <a id="1619" href="Algebra.Solver.CommutativeMonoid.html#1619" class="Bound">n</a> <a id="1621" class="Symbol">=</a> <a id="1623" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="1627" href="Algebra.Bundles.html#6694" class="Field">Carrier</a> <a id="1635" href="Algebra.Solver.CommutativeMonoid.html#1619" class="Bound">n</a>

<a id="1638" class="Comment">-- The semantics of an expression is a function from an environment to</a>
<a id="1709" class="Comment">-- a value.</a>

<a id="⟦_⟧"></a><a id="1722" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦_⟧</a> <a id="1726" class="Symbol">:</a> <a id="1728" class="Symbol">∀</a> <a id="1730" class="Symbol">{</a><a id="1731" href="Algebra.Solver.CommutativeMonoid.html#1731" class="Bound">n</a><a id="1732" class="Symbol">}</a> <a id="1734" class="Symbol">→</a> <a id="1736" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="1741" href="Algebra.Solver.CommutativeMonoid.html#1731" class="Bound">n</a> <a id="1743" class="Symbol">→</a> <a id="1745" href="Algebra.Solver.CommutativeMonoid.html#1599" class="Function">Env</a> <a id="1749" href="Algebra.Solver.CommutativeMonoid.html#1731" class="Bound">n</a> <a id="1751" class="Symbol">→</a> <a id="1753" href="Algebra.Bundles.html#6694" class="Field">Carrier</a>
<a id="1761" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="1763" href="Algebra.Solver.CommutativeMonoid.html#1471" class="InductiveConstructor">var</a> <a id="1767" href="Algebra.Solver.CommutativeMonoid.html#1767" class="Bound">x</a>   <a id="1771" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="1773" href="Algebra.Solver.CommutativeMonoid.html#1773" class="Bound">ρ</a> <a id="1775" class="Symbol">=</a> <a id="1777" href="Data.Vec.Base.html#1643" class="Function">lookup</a> <a id="1784" href="Algebra.Solver.CommutativeMonoid.html#1773" class="Bound">ρ</a> <a id="1786" href="Algebra.Solver.CommutativeMonoid.html#1767" class="Bound">x</a>
<a id="1788" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="1790" href="Algebra.Solver.CommutativeMonoid.html#1494" class="InductiveConstructor">id</a>      <a id="1798" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="1800" href="Algebra.Solver.CommutativeMonoid.html#1800" class="Bound">ρ</a> <a id="1802" class="Symbol">=</a> <a id="1804" href="Algebra.Bundles.html#6804" class="Field">ε</a>
<a id="1806" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="1808" href="Algebra.Solver.CommutativeMonoid.html#1808" class="Bound">e₁</a> <a id="1811" href="Algebra.Solver.CommutativeMonoid.html#1509" class="InductiveConstructor Operator">⊕</a> <a id="1813" href="Algebra.Solver.CommutativeMonoid.html#1813" class="Bound">e₂</a> <a id="1816" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="1818" href="Algebra.Solver.CommutativeMonoid.html#1818" class="Bound">ρ</a> <a id="1820" class="Symbol">=</a> <a id="1822" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="1824" href="Algebra.Solver.CommutativeMonoid.html#1808" class="Bound">e₁</a> <a id="1827" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="1829" href="Algebra.Solver.CommutativeMonoid.html#1818" class="Bound">ρ</a> <a id="1831" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="1833" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="1835" href="Algebra.Solver.CommutativeMonoid.html#1813" class="Bound">e₂</a> <a id="1838" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="1840" href="Algebra.Solver.CommutativeMonoid.html#1818" class="Bound">ρ</a>

<a id="1843" class="Comment">------------------------------------------------------------------------</a>
<a id="1916" class="Comment">-- Normal forms</a>

<a id="1933" class="Comment">-- A normal form is a vector of multiplicities (a bag).</a>

<a id="Normal"></a><a id="1990" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="1997" class="Symbol">:</a> <a id="1999" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2001" class="Symbol">→</a> <a id="2003" href="Agda.Primitive.html#320" class="Primitive">Set</a>
<a id="2007" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="2014" href="Algebra.Solver.CommutativeMonoid.html#2014" class="Bound">n</a> <a id="2016" class="Symbol">=</a> <a id="2018" href="Data.Vec.Base.html#1086" class="Datatype">Vec</a> <a id="2022" href="Agda.Builtin.Nat.html#186" class="Datatype">ℕ</a> <a id="2024" href="Algebra.Solver.CommutativeMonoid.html#2014" class="Bound">n</a>

<a id="2027" class="Comment">-- The semantics of a normal form.</a>

<a id="⟦_⟧⇓"></a><a id="2063" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦_⟧⇓</a> <a id="2068" class="Symbol">:</a> <a id="2070" class="Symbol">∀</a> <a id="2072" class="Symbol">{</a><a id="2073" href="Algebra.Solver.CommutativeMonoid.html#2073" class="Bound">n</a><a id="2074" class="Symbol">}</a> <a id="2076" class="Symbol">→</a> <a id="2078" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="2085" href="Algebra.Solver.CommutativeMonoid.html#2073" class="Bound">n</a> <a id="2087" class="Symbol">→</a> <a id="2089" href="Algebra.Solver.CommutativeMonoid.html#1599" class="Function">Env</a> <a id="2093" href="Algebra.Solver.CommutativeMonoid.html#2073" class="Bound">n</a> <a id="2095" class="Symbol">→</a> <a id="2097" href="Algebra.Bundles.html#6694" class="Field">Carrier</a>
<a id="2105" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="2107" href="Data.Vec.Base.html#1122" class="InductiveConstructor">[]</a>    <a id="2113" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="2116" class="Symbol">_</a> <a id="2118" class="Symbol">=</a> <a id="2120" href="Algebra.Bundles.html#6804" class="Field">ε</a>
<a id="2122" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="2124" href="Algebra.Solver.CommutativeMonoid.html#2124" class="Bound">n</a> <a id="2126" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="2128" href="Algebra.Solver.CommutativeMonoid.html#2128" class="Bound">v</a> <a id="2130" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="2133" class="Symbol">(</a><a id="2134" href="Algebra.Solver.CommutativeMonoid.html#2134" class="Bound">a</a> <a id="2136" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="2138" href="Algebra.Solver.CommutativeMonoid.html#2138" class="Bound">ρ</a><a id="2139" class="Symbol">)</a> <a id="2141" class="Symbol">=</a> <a id="2143" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a> <a id="2148" class="Symbol">(</a><a id="2149" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="2151" href="Algebra.Solver.CommutativeMonoid.html#2128" class="Bound">v</a> <a id="2153" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="2156" href="Algebra.Solver.CommutativeMonoid.html#2138" class="Bound">ρ</a><a id="2157" class="Symbol">)</a> <a id="2159" class="Symbol">(λ</a> <a id="2162" href="Algebra.Solver.CommutativeMonoid.html#2162" class="Bound">b</a> <a id="2164" class="Symbol">→</a> <a id="2166" href="Algebra.Solver.CommutativeMonoid.html#2134" class="Bound">a</a> <a id="2168" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="2170" href="Algebra.Solver.CommutativeMonoid.html#2162" class="Bound">b</a><a id="2171" class="Symbol">)</a> <a id="2173" href="Algebra.Solver.CommutativeMonoid.html#2124" class="Bound">n</a>

<a id="2176" class="Comment">------------------------------------------------------------------------</a>
<a id="2249" class="Comment">-- Constructions on normal forms</a>

<a id="2283" class="Comment">-- The empty bag.</a>

<a id="empty"></a><a id="2302" href="Algebra.Solver.CommutativeMonoid.html#2302" class="Function">empty</a> <a id="2308" class="Symbol">:</a> <a id="2310" class="Symbol">∀{</a><a id="2312" href="Algebra.Solver.CommutativeMonoid.html#2312" class="Bound">n</a><a id="2313" class="Symbol">}</a> <a id="2315" class="Symbol">→</a> <a id="2317" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="2324" href="Algebra.Solver.CommutativeMonoid.html#2312" class="Bound">n</a>
<a id="2326" href="Algebra.Solver.CommutativeMonoid.html#2302" class="Function">empty</a> <a id="2332" class="Symbol">=</a> <a id="2334" href="Data.Vec.Base.html#6404" class="Function">replicate</a> <a id="2344" class="Number">0</a>

<a id="2347" class="Comment">-- A singleton bag.</a>

<a id="sg"></a><a id="2368" href="Algebra.Solver.CommutativeMonoid.html#2368" class="Function">sg</a> <a id="2371" class="Symbol">:</a> <a id="2373" class="Symbol">∀{</a><a id="2375" href="Algebra.Solver.CommutativeMonoid.html#2375" class="Bound">n</a><a id="2376" class="Symbol">}</a> <a id="2378" class="Symbol">(</a><a id="2379" href="Algebra.Solver.CommutativeMonoid.html#2379" class="Bound">i</a> <a id="2381" class="Symbol">:</a> <a id="2383" href="Data.Fin.Base.html#1312" class="Datatype">Fin</a> <a id="2387" href="Algebra.Solver.CommutativeMonoid.html#2375" class="Bound">n</a><a id="2388" class="Symbol">)</a> <a id="2390" class="Symbol">→</a> <a id="2392" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="2399" href="Algebra.Solver.CommutativeMonoid.html#2375" class="Bound">n</a>
<a id="2401" href="Algebra.Solver.CommutativeMonoid.html#2368" class="Function">sg</a> <a id="2404" href="Data.Fin.Base.html#1334" class="InductiveConstructor">zero</a>    <a id="2412" class="Symbol">=</a> <a id="2414" class="Number">1</a> <a id="2416" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="2418" href="Algebra.Solver.CommutativeMonoid.html#2302" class="Function">empty</a>
<a id="2424" href="Algebra.Solver.CommutativeMonoid.html#2368" class="Function">sg</a> <a id="2427" class="Symbol">(</a><a id="2428" href="Data.Fin.Base.html#1355" class="InductiveConstructor">suc</a> <a id="2432" href="Algebra.Solver.CommutativeMonoid.html#2432" class="Bound">i</a><a id="2433" class="Symbol">)</a> <a id="2435" class="Symbol">=</a> <a id="2437" class="Number">0</a> <a id="2439" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="2441" href="Algebra.Solver.CommutativeMonoid.html#2368" class="Function">sg</a> <a id="2444" href="Algebra.Solver.CommutativeMonoid.html#2432" class="Bound">i</a>

<a id="2447" class="Comment">-- The composition of normal forms.</a>

<a id="_•_"></a><a id="2484" href="Algebra.Solver.CommutativeMonoid.html#2484" class="Function Operator">_•_</a>  <a id="2489" class="Symbol">:</a> <a id="2491" class="Symbol">∀{</a><a id="2493" href="Algebra.Solver.CommutativeMonoid.html#2493" class="Bound">n</a><a id="2494" class="Symbol">}</a> <a id="2496" class="Symbol">(</a><a id="2497" href="Algebra.Solver.CommutativeMonoid.html#2497" class="Bound">v</a> <a id="2499" href="Algebra.Solver.CommutativeMonoid.html#2499" class="Bound">w</a> <a id="2501" class="Symbol">:</a> <a id="2503" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="2510" href="Algebra.Solver.CommutativeMonoid.html#2493" class="Bound">n</a><a id="2511" class="Symbol">)</a> <a id="2513" class="Symbol">→</a> <a id="2515" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="2522" href="Algebra.Solver.CommutativeMonoid.html#2493" class="Bound">n</a>
<a id="2524" href="Data.Vec.Base.html#1122" class="InductiveConstructor">[]</a>      <a id="2532" href="Algebra.Solver.CommutativeMonoid.html#2484" class="Function Operator">•</a> <a id="2534" href="Data.Vec.Base.html#1122" class="InductiveConstructor">[]</a>      <a id="2542" class="Symbol">=</a> <a id="2544" href="Data.Vec.Base.html#1122" class="InductiveConstructor">[]</a>
<a id="2547" class="Symbol">(</a><a id="2548" href="Algebra.Solver.CommutativeMonoid.html#2548" class="Bound">l</a> <a id="2550" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="2552" href="Algebra.Solver.CommutativeMonoid.html#2552" class="Bound">v</a><a id="2553" class="Symbol">)</a> <a id="2555" href="Algebra.Solver.CommutativeMonoid.html#2484" class="Function Operator">•</a> <a id="2557" class="Symbol">(</a><a id="2558" href="Algebra.Solver.CommutativeMonoid.html#2558" class="Bound">m</a> <a id="2560" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="2562" href="Algebra.Solver.CommutativeMonoid.html#2562" class="Bound">w</a><a id="2563" class="Symbol">)</a> <a id="2565" class="Symbol">=</a> <a id="2567" href="Algebra.Solver.CommutativeMonoid.html#2548" class="Bound">l</a> <a id="2569" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="2571" href="Algebra.Solver.CommutativeMonoid.html#2558" class="Bound">m</a> <a id="2573" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="2575" href="Algebra.Solver.CommutativeMonoid.html#2552" class="Bound">v</a> <a id="2577" href="Algebra.Solver.CommutativeMonoid.html#2484" class="Function Operator">•</a> <a id="2579" href="Algebra.Solver.CommutativeMonoid.html#2562" class="Bound">w</a>

<a id="2582" class="Comment">------------------------------------------------------------------------</a>
<a id="2655" class="Comment">-- Correctness of the constructions on normal forms</a>

<a id="2708" class="Comment">-- The empty bag stands for the unit ε.</a>

<a id="empty-correct"></a><a id="2749" href="Algebra.Solver.CommutativeMonoid.html#2749" class="Function">empty-correct</a> <a id="2763" class="Symbol">:</a> <a id="2765" class="Symbol">∀{</a><a id="2767" href="Algebra.Solver.CommutativeMonoid.html#2767" class="Bound">n</a><a id="2768" class="Symbol">}</a> <a id="2770" class="Symbol">(</a><a id="2771" href="Algebra.Solver.CommutativeMonoid.html#2771" class="Bound">ρ</a> <a id="2773" class="Symbol">:</a> <a id="2775" href="Algebra.Solver.CommutativeMonoid.html#1599" class="Function">Env</a> <a id="2779" href="Algebra.Solver.CommutativeMonoid.html#2767" class="Bound">n</a><a id="2780" class="Symbol">)</a> <a id="2782" class="Symbol">→</a> <a id="2784" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="2786" href="Algebra.Solver.CommutativeMonoid.html#2302" class="Function">empty</a> <a id="2792" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="2795" href="Algebra.Solver.CommutativeMonoid.html#2771" class="Bound">ρ</a> <a id="2797" href="Algebra.Bundles.html#6726" class="Field Operator">≈</a> <a id="2799" href="Algebra.Bundles.html#6804" class="Field">ε</a>
<a id="2801" href="Algebra.Solver.CommutativeMonoid.html#2749" class="Function">empty-correct</a> <a id="2815" href="Data.Vec.Base.html#1122" class="InductiveConstructor">[]</a> <a id="2818" class="Symbol">=</a> <a id="2820" href="Relation.Binary.Structures.html#1596" class="Function">refl</a>
<a id="2825" href="Algebra.Solver.CommutativeMonoid.html#2749" class="Function">empty-correct</a> <a id="2839" class="Symbol">(</a><a id="2840" href="Algebra.Solver.CommutativeMonoid.html#2840" class="Bound">a</a> <a id="2842" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="2844" href="Algebra.Solver.CommutativeMonoid.html#2844" class="Bound">ρ</a><a id="2845" class="Symbol">)</a> <a id="2847" class="Symbol">=</a> <a id="2849" href="Algebra.Solver.CommutativeMonoid.html#2749" class="Function">empty-correct</a> <a id="2863" href="Algebra.Solver.CommutativeMonoid.html#2844" class="Bound">ρ</a>

<a id="2866" class="Comment">-- The singleton bag stands for a single variable.</a>

<a id="sg-correct"></a><a id="2918" href="Algebra.Solver.CommutativeMonoid.html#2918" class="Function">sg-correct</a> <a id="2929" class="Symbol">:</a> <a id="2931" class="Symbol">∀{</a><a id="2933" href="Algebra.Solver.CommutativeMonoid.html#2933" class="Bound">n</a><a id="2934" class="Symbol">}</a> <a id="2936" class="Symbol">(</a><a id="2937" href="Algebra.Solver.CommutativeMonoid.html#2937" class="Bound">x</a> <a id="2939" class="Symbol">:</a> <a id="2941" href="Data.Fin.Base.html#1312" class="Datatype">Fin</a> <a id="2945" href="Algebra.Solver.CommutativeMonoid.html#2933" class="Bound">n</a><a id="2946" class="Symbol">)</a> <a id="2948" class="Symbol">(</a><a id="2949" href="Algebra.Solver.CommutativeMonoid.html#2949" class="Bound">ρ</a> <a id="2951" class="Symbol">:</a> <a id="2953" href="Algebra.Solver.CommutativeMonoid.html#1599" class="Function">Env</a> <a id="2957" href="Algebra.Solver.CommutativeMonoid.html#2933" class="Bound">n</a><a id="2958" class="Symbol">)</a> <a id="2960" class="Symbol">→</a>  <a id="2963" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="2965" href="Algebra.Solver.CommutativeMonoid.html#2368" class="Function">sg</a> <a id="2968" href="Algebra.Solver.CommutativeMonoid.html#2937" class="Bound">x</a> <a id="2970" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="2973" href="Algebra.Solver.CommutativeMonoid.html#2949" class="Bound">ρ</a> <a id="2975" href="Algebra.Bundles.html#6726" class="Field Operator">≈</a> <a id="2977" href="Data.Vec.Base.html#1643" class="Function">lookup</a> <a id="2984" href="Algebra.Solver.CommutativeMonoid.html#2949" class="Bound">ρ</a> <a id="2986" href="Algebra.Solver.CommutativeMonoid.html#2937" class="Bound">x</a>
<a id="2988" href="Algebra.Solver.CommutativeMonoid.html#2918" class="Function">sg-correct</a> <a id="2999" href="Data.Fin.Base.html#1334" class="InductiveConstructor">zero</a> <a id="3004" class="Symbol">(</a><a id="3005" href="Algebra.Solver.CommutativeMonoid.html#3005" class="Bound">x</a> <a id="3007" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="3009" href="Algebra.Solver.CommutativeMonoid.html#3009" class="Bound">ρ</a><a id="3010" class="Symbol">)</a> <a id="3012" class="Symbol">=</a> <a id="3014" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
    <a id="3024" href="Algebra.Solver.CommutativeMonoid.html#3005" class="Bound">x</a> <a id="3026" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3028" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="3030" href="Algebra.Solver.CommutativeMonoid.html#2302" class="Function">empty</a> <a id="3036" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="3039" href="Algebra.Solver.CommutativeMonoid.html#3009" class="Bound">ρ</a>   <a id="3043" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">≈⟨</a> <a id="3046" href="Algebra.Structures.html#1465" class="Function">∙-congˡ</a> <a id="3054" class="Symbol">(</a><a id="3055" href="Algebra.Solver.CommutativeMonoid.html#2749" class="Function">empty-correct</a> <a id="3069" href="Algebra.Solver.CommutativeMonoid.html#3009" class="Bound">ρ</a><a id="3070" class="Symbol">)</a> <a id="3072" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">⟩</a>
    <a id="3078" href="Algebra.Solver.CommutativeMonoid.html#3005" class="Bound">x</a> <a id="3080" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3082" href="Algebra.Bundles.html#6804" class="Field">ε</a>              <a id="3097" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">≈⟨</a> <a id="3100" href="Algebra.Structures.html#4197" class="Function">identityʳ</a> <a id="3110" class="Symbol">_</a> <a id="3112" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">⟩</a>
    <a id="3118" href="Algebra.Solver.CommutativeMonoid.html#3005" class="Bound">x</a>                  <a id="3137" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a>
<a id="3139" href="Algebra.Solver.CommutativeMonoid.html#2918" class="Function">sg-correct</a> <a id="3150" class="Symbol">(</a><a id="3151" href="Data.Fin.Base.html#1355" class="InductiveConstructor">suc</a> <a id="3155" href="Algebra.Solver.CommutativeMonoid.html#3155" class="Bound">x</a><a id="3156" class="Symbol">)</a> <a id="3158" class="Symbol">(</a><a id="3159" href="Algebra.Solver.CommutativeMonoid.html#3159" class="Bound">m</a> <a id="3161" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="3163" href="Algebra.Solver.CommutativeMonoid.html#3163" class="Bound">ρ</a><a id="3164" class="Symbol">)</a> <a id="3166" class="Symbol">=</a> <a id="3168" href="Algebra.Solver.CommutativeMonoid.html#2918" class="Function">sg-correct</a> <a id="3179" href="Algebra.Solver.CommutativeMonoid.html#3155" class="Bound">x</a> <a id="3181" href="Algebra.Solver.CommutativeMonoid.html#3163" class="Bound">ρ</a>

<a id="3184" class="Comment">-- Normal form composition corresponds to the composition of the monoid.</a>

<a id="comp-correct"></a><a id="3258" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Function">comp-correct</a> <a id="3271" class="Symbol">:</a> <a id="3273" class="Symbol">∀</a> <a id="3275" class="Symbol">{</a><a id="3276" href="Algebra.Solver.CommutativeMonoid.html#3276" class="Bound">n</a><a id="3277" class="Symbol">}</a> <a id="3279" class="Symbol">(</a><a id="3280" href="Algebra.Solver.CommutativeMonoid.html#3280" class="Bound">v</a> <a id="3282" href="Algebra.Solver.CommutativeMonoid.html#3282" class="Bound">w</a> <a id="3284" class="Symbol">:</a> <a id="3286" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="3293" href="Algebra.Solver.CommutativeMonoid.html#3276" class="Bound">n</a><a id="3294" class="Symbol">)</a> <a id="3296" class="Symbol">(</a><a id="3297" href="Algebra.Solver.CommutativeMonoid.html#3297" class="Bound">ρ</a> <a id="3299" class="Symbol">:</a> <a id="3301" href="Algebra.Solver.CommutativeMonoid.html#1599" class="Function">Env</a> <a id="3305" href="Algebra.Solver.CommutativeMonoid.html#3276" class="Bound">n</a><a id="3306" class="Symbol">)</a> <a id="3308" class="Symbol">→</a>
              <a id="3324" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="3326" href="Algebra.Solver.CommutativeMonoid.html#3280" class="Bound">v</a> <a id="3328" href="Algebra.Solver.CommutativeMonoid.html#2484" class="Function Operator">•</a> <a id="3330" href="Algebra.Solver.CommutativeMonoid.html#3282" class="Bound">w</a> <a id="3332" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="3335" href="Algebra.Solver.CommutativeMonoid.html#3297" class="Bound">ρ</a> <a id="3337" href="Algebra.Bundles.html#6726" class="Field Operator">≈</a> <a id="3339" class="Symbol">(</a><a id="3340" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="3342" href="Algebra.Solver.CommutativeMonoid.html#3280" class="Bound">v</a> <a id="3344" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="3347" href="Algebra.Solver.CommutativeMonoid.html#3297" class="Bound">ρ</a> <a id="3349" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3351" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="3353" href="Algebra.Solver.CommutativeMonoid.html#3282" class="Bound">w</a> <a id="3355" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="3358" href="Algebra.Solver.CommutativeMonoid.html#3297" class="Bound">ρ</a><a id="3359" class="Symbol">)</a>
<a id="3361" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Function">comp-correct</a> <a id="3374" href="Data.Vec.Base.html#1122" class="InductiveConstructor">[]</a> <a id="3377" href="Data.Vec.Base.html#1122" class="InductiveConstructor">[]</a> <a id="3380" href="Algebra.Solver.CommutativeMonoid.html#3380" class="Bound">ρ</a> <a id="3382" class="Symbol">=</a>  <a id="3385" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="3389" class="Symbol">(</a><a id="3390" href="Algebra.Structures.html#4136" class="Function">identityˡ</a> <a id="3400" class="Symbol">_)</a>
<a id="3403" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Function">comp-correct</a> <a id="3416" class="Symbol">(</a><a id="3417" href="Algebra.Solver.CommutativeMonoid.html#3417" class="Bound">l</a> <a id="3419" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="3421" href="Algebra.Solver.CommutativeMonoid.html#3421" class="Bound">v</a><a id="3422" class="Symbol">)</a> <a id="3424" class="Symbol">(</a><a id="3425" href="Algebra.Solver.CommutativeMonoid.html#3425" class="Bound">m</a> <a id="3427" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="3429" href="Algebra.Solver.CommutativeMonoid.html#3429" class="Bound">w</a><a id="3430" class="Symbol">)</a> <a id="3432" class="Symbol">(</a><a id="3433" href="Algebra.Solver.CommutativeMonoid.html#3433" class="Bound">a</a> <a id="3435" href="Data.Vec.Base.html#1141" class="InductiveConstructor Operator">∷</a> <a id="3437" href="Algebra.Solver.CommutativeMonoid.html#3437" class="Bound">ρ</a><a id="3438" class="Symbol">)</a> <a id="3440" class="Symbol">=</a> <a id="3442" href="Algebra.Solver.CommutativeMonoid.html#3709" class="Function">lemma</a> <a id="3448" href="Algebra.Solver.CommutativeMonoid.html#3417" class="Bound">l</a> <a id="3450" href="Algebra.Solver.CommutativeMonoid.html#3425" class="Bound">m</a> <a id="3452" class="Symbol">(</a><a id="3453" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Function">comp-correct</a> <a id="3466" href="Algebra.Solver.CommutativeMonoid.html#3421" class="Bound">v</a> <a id="3468" href="Algebra.Solver.CommutativeMonoid.html#3429" class="Bound">w</a> <a id="3470" href="Algebra.Solver.CommutativeMonoid.html#3437" class="Bound">ρ</a><a id="3471" class="Symbol">)</a>
  <a id="3475" class="Keyword">where</a>
    <a id="3485" href="Algebra.Solver.CommutativeMonoid.html#3485" class="Function">flip12</a> <a id="3492" class="Symbol">:</a> <a id="3494" class="Symbol">∀</a> <a id="3496" href="Algebra.Solver.CommutativeMonoid.html#3496" class="Bound">a</a> <a id="3498" href="Algebra.Solver.CommutativeMonoid.html#3498" class="Bound">b</a> <a id="3500" href="Algebra.Solver.CommutativeMonoid.html#3500" class="Bound">c</a> <a id="3502" class="Symbol">→</a> <a id="3504" href="Algebra.Solver.CommutativeMonoid.html#3496" class="Bound">a</a> <a id="3506" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3508" class="Symbol">(</a><a id="3509" href="Algebra.Solver.CommutativeMonoid.html#3498" class="Bound">b</a> <a id="3511" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3513" href="Algebra.Solver.CommutativeMonoid.html#3500" class="Bound">c</a><a id="3514" class="Symbol">)</a> <a id="3516" href="Algebra.Bundles.html#6726" class="Field Operator">≈</a> <a id="3518" href="Algebra.Solver.CommutativeMonoid.html#3498" class="Bound">b</a> <a id="3520" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3522" class="Symbol">(</a><a id="3523" href="Algebra.Solver.CommutativeMonoid.html#3496" class="Bound">a</a> <a id="3525" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3527" href="Algebra.Solver.CommutativeMonoid.html#3500" class="Bound">c</a><a id="3528" class="Symbol">)</a>
    <a id="3534" href="Algebra.Solver.CommutativeMonoid.html#3485" class="Function">flip12</a> <a id="3541" href="Algebra.Solver.CommutativeMonoid.html#3541" class="Bound">a</a> <a id="3543" href="Algebra.Solver.CommutativeMonoid.html#3543" class="Bound">b</a> <a id="3545" href="Algebra.Solver.CommutativeMonoid.html#3545" class="Bound">c</a> <a id="3547" class="Symbol">=</a> <a id="3549" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
        <a id="3563" href="Algebra.Solver.CommutativeMonoid.html#3541" class="Bound">a</a> <a id="3565" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3567" class="Symbol">(</a><a id="3568" href="Algebra.Solver.CommutativeMonoid.html#3543" class="Bound">b</a> <a id="3570" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3572" href="Algebra.Solver.CommutativeMonoid.html#3545" class="Bound">c</a><a id="3573" class="Symbol">)</a>  <a id="3576" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">≈⟨</a> <a id="3579" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="3583" class="Symbol">(</a><a id="3584" href="Algebra.Structures.html#2977" class="Function">assoc</a> <a id="3590" class="Symbol">_</a> <a id="3592" class="Symbol">_</a> <a id="3594" class="Symbol">_)</a> <a id="3597" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">⟩</a>
        <a id="3607" class="Symbol">(</a><a id="3608" href="Algebra.Solver.CommutativeMonoid.html#3541" class="Bound">a</a> <a id="3610" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3612" href="Algebra.Solver.CommutativeMonoid.html#3543" class="Bound">b</a><a id="3613" class="Symbol">)</a> <a id="3615" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3617" href="Algebra.Solver.CommutativeMonoid.html#3545" class="Bound">c</a>  <a id="3620" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">≈⟨</a> <a id="3623" href="Algebra.Structures.html#1526" class="Function">∙-congʳ</a> <a id="3631" class="Symbol">(</a><a id="3632" href="Algebra.Structures.html#4484" class="Function">comm</a> <a id="3637" class="Symbol">_</a> <a id="3639" class="Symbol">_)</a> <a id="3642" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">⟩</a>
        <a id="3652" class="Symbol">(</a><a id="3653" href="Algebra.Solver.CommutativeMonoid.html#3543" class="Bound">b</a> <a id="3655" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3657" href="Algebra.Solver.CommutativeMonoid.html#3541" class="Bound">a</a><a id="3658" class="Symbol">)</a> <a id="3660" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3662" href="Algebra.Solver.CommutativeMonoid.html#3545" class="Bound">c</a>  <a id="3665" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">≈⟨</a> <a id="3668" href="Algebra.Structures.html#2977" class="Function">assoc</a> <a id="3674" class="Symbol">_</a> <a id="3676" class="Symbol">_</a> <a id="3678" class="Symbol">_</a> <a id="3680" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">⟩</a>
        <a id="3690" href="Algebra.Solver.CommutativeMonoid.html#3543" class="Bound">b</a> <a id="3692" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3694" class="Symbol">(</a><a id="3695" href="Algebra.Solver.CommutativeMonoid.html#3541" class="Bound">a</a> <a id="3697" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3699" href="Algebra.Solver.CommutativeMonoid.html#3545" class="Bound">c</a><a id="3700" class="Symbol">)</a>  <a id="3703" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a>
    <a id="3709" href="Algebra.Solver.CommutativeMonoid.html#3709" class="Function">lemma</a> <a id="3715" class="Symbol">:</a> <a id="3717" class="Symbol">∀</a> <a id="3719" href="Algebra.Solver.CommutativeMonoid.html#3719" class="Bound">l</a> <a id="3721" href="Algebra.Solver.CommutativeMonoid.html#3721" class="Bound">m</a> <a id="3723" class="Symbol">{</a><a id="3724" href="Algebra.Solver.CommutativeMonoid.html#3724" class="Bound">d</a> <a id="3726" href="Algebra.Solver.CommutativeMonoid.html#3726" class="Bound">b</a> <a id="3728" href="Algebra.Solver.CommutativeMonoid.html#3728" class="Bound">c</a><a id="3729" class="Symbol">}</a> <a id="3731" class="Symbol">(</a><a id="3732" href="Algebra.Solver.CommutativeMonoid.html#3732" class="Bound">p</a> <a id="3734" class="Symbol">:</a> <a id="3736" href="Algebra.Solver.CommutativeMonoid.html#3724" class="Bound">d</a> <a id="3738" href="Algebra.Bundles.html#6726" class="Field Operator">≈</a> <a id="3740" href="Algebra.Solver.CommutativeMonoid.html#3726" class="Bound">b</a> <a id="3742" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3744" href="Algebra.Solver.CommutativeMonoid.html#3728" class="Bound">c</a><a id="3745" class="Symbol">)</a> <a id="3747" class="Symbol">→</a>
      <a id="3755" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a> <a id="3760" href="Algebra.Solver.CommutativeMonoid.html#3724" class="Bound">d</a> <a id="3762" class="Symbol">(</a><a id="3763" href="Algebra.Solver.CommutativeMonoid.html#3433" class="Bound">a</a> <a id="3765" href="Algebra.Bundles.html#6766" class="Field Operator">∙_</a><a id="3767" class="Symbol">)</a> <a id="3769" class="Symbol">(</a><a id="3770" href="Algebra.Solver.CommutativeMonoid.html#3719" class="Bound">l</a> <a id="3772" href="Agda.Builtin.Nat.html#319" class="Primitive Operator">+</a> <a id="3774" href="Algebra.Solver.CommutativeMonoid.html#3721" class="Bound">m</a><a id="3775" class="Symbol">)</a> <a id="3777" href="Algebra.Bundles.html#6726" class="Field Operator">≈</a> <a id="3779" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a> <a id="3784" href="Algebra.Solver.CommutativeMonoid.html#3726" class="Bound">b</a> <a id="3786" class="Symbol">(</a><a id="3787" href="Algebra.Solver.CommutativeMonoid.html#3433" class="Bound">a</a> <a id="3789" href="Algebra.Bundles.html#6766" class="Field Operator">∙_</a><a id="3791" class="Symbol">)</a> <a id="3793" href="Algebra.Solver.CommutativeMonoid.html#3719" class="Bound">l</a> <a id="3795" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="3797" href="Data.Nat.GeneralisedArithmetic.html#573" class="Function">fold</a> <a id="3802" href="Algebra.Solver.CommutativeMonoid.html#3728" class="Bound">c</a> <a id="3804" class="Symbol">(</a><a id="3805" href="Algebra.Solver.CommutativeMonoid.html#3433" class="Bound">a</a> <a id="3807" href="Algebra.Bundles.html#6766" class="Field Operator">∙_</a><a id="3809" class="Symbol">)</a> <a id="3811" href="Algebra.Solver.CommutativeMonoid.html#3721" class="Bound">m</a>
    <a id="3817" href="Algebra.Solver.CommutativeMonoid.html#3709" class="Function">lemma</a> <a id="3823" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a> <a id="3828" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a> <a id="3833" href="Algebra.Solver.CommutativeMonoid.html#3833" class="Bound">p</a> <a id="3835" class="Symbol">=</a> <a id="3837" href="Algebra.Solver.CommutativeMonoid.html#3833" class="Bound">p</a>
    <a id="3843" href="Algebra.Solver.CommutativeMonoid.html#3709" class="Function">lemma</a> <a id="3849" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a> <a id="3854" class="Symbol">(</a><a id="3855" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3859" href="Algebra.Solver.CommutativeMonoid.html#3859" class="Bound">m</a><a id="3860" class="Symbol">)</a> <a id="3862" href="Algebra.Solver.CommutativeMonoid.html#3862" class="Bound">p</a> <a id="3864" class="Symbol">=</a> <a id="3866" href="Relation.Binary.Structures.html#1648" class="Function">trans</a> <a id="3872" class="Symbol">(</a><a id="3873" href="Algebra.Structures.html#1465" class="Function">∙-congˡ</a> <a id="3881" class="Symbol">(</a><a id="3882" href="Algebra.Solver.CommutativeMonoid.html#3709" class="Function">lemma</a> <a id="3888" href="Agda.Builtin.Nat.html#204" class="InductiveConstructor">zero</a> <a id="3893" href="Algebra.Solver.CommutativeMonoid.html#3859" class="Bound">m</a> <a id="3895" href="Algebra.Solver.CommutativeMonoid.html#3862" class="Bound">p</a><a id="3896" class="Symbol">))</a> <a id="3899" class="Symbol">(</a><a id="3900" href="Algebra.Solver.CommutativeMonoid.html#3485" class="Function">flip12</a> <a id="3907" class="Symbol">_</a> <a id="3909" class="Symbol">_</a> <a id="3911" class="Symbol">_)</a>
    <a id="3918" href="Algebra.Solver.CommutativeMonoid.html#3709" class="Function">lemma</a> <a id="3924" class="Symbol">(</a><a id="3925" href="Agda.Builtin.Nat.html#217" class="InductiveConstructor">suc</a> <a id="3929" href="Algebra.Solver.CommutativeMonoid.html#3929" class="Bound">l</a><a id="3930" class="Symbol">)</a> <a id="3932" href="Algebra.Solver.CommutativeMonoid.html#3932" class="Bound">m</a> <a id="3934" href="Algebra.Solver.CommutativeMonoid.html#3934" class="Bound">p</a> <a id="3936" class="Symbol">=</a> <a id="3938" href="Relation.Binary.Structures.html#1648" class="Function">trans</a> <a id="3944" class="Symbol">(</a><a id="3945" href="Algebra.Structures.html#1465" class="Function">∙-congˡ</a> <a id="3953" class="Symbol">(</a><a id="3954" href="Algebra.Solver.CommutativeMonoid.html#3709" class="Function">lemma</a> <a id="3960" href="Algebra.Solver.CommutativeMonoid.html#3929" class="Bound">l</a> <a id="3962" href="Algebra.Solver.CommutativeMonoid.html#3932" class="Bound">m</a> <a id="3964" href="Algebra.Solver.CommutativeMonoid.html#3934" class="Bound">p</a><a id="3965" class="Symbol">))</a> <a id="3968" class="Symbol">(</a><a id="3969" href="Relation.Binary.Structures.html#1622" class="Function">sym</a> <a id="3973" class="Symbol">(</a><a id="3974" href="Algebra.Structures.html#2977" class="Function">assoc</a> <a id="3980" href="Algebra.Solver.CommutativeMonoid.html#3433" class="Bound">a</a> <a id="3982" class="Symbol">_</a> <a id="3984" class="Symbol">_))</a>

<a id="3989" class="Comment">------------------------------------------------------------------------</a>
<a id="4062" class="Comment">-- Normalization</a>

<a id="4080" class="Comment">-- A normaliser.</a>

<a id="normalise"></a><a id="4098" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4108" class="Symbol">:</a> <a id="4110" class="Symbol">∀</a> <a id="4112" class="Symbol">{</a><a id="4113" href="Algebra.Solver.CommutativeMonoid.html#4113" class="Bound">n</a><a id="4114" class="Symbol">}</a> <a id="4116" class="Symbol">→</a> <a id="4118" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="4123" href="Algebra.Solver.CommutativeMonoid.html#4113" class="Bound">n</a> <a id="4125" class="Symbol">→</a> <a id="4127" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="4134" href="Algebra.Solver.CommutativeMonoid.html#4113" class="Bound">n</a>
<a id="4136" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4146" class="Symbol">(</a><a id="4147" href="Algebra.Solver.CommutativeMonoid.html#1471" class="InductiveConstructor">var</a> <a id="4151" href="Algebra.Solver.CommutativeMonoid.html#4151" class="Bound">x</a><a id="4152" class="Symbol">)</a>   <a id="4156" class="Symbol">=</a> <a id="4158" href="Algebra.Solver.CommutativeMonoid.html#2368" class="Function">sg</a> <a id="4161" href="Algebra.Solver.CommutativeMonoid.html#4151" class="Bound">x</a>
<a id="4163" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4173" href="Algebra.Solver.CommutativeMonoid.html#1494" class="InductiveConstructor">id</a>        <a id="4183" class="Symbol">=</a> <a id="4185" href="Algebra.Solver.CommutativeMonoid.html#2302" class="Function">empty</a>
<a id="4191" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4201" class="Symbol">(</a><a id="4202" href="Algebra.Solver.CommutativeMonoid.html#4202" class="Bound">e₁</a> <a id="4205" href="Algebra.Solver.CommutativeMonoid.html#1509" class="InductiveConstructor Operator">⊕</a> <a id="4207" href="Algebra.Solver.CommutativeMonoid.html#4207" class="Bound">e₂</a><a id="4209" class="Symbol">)</a> <a id="4211" class="Symbol">=</a> <a id="4213" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4223" href="Algebra.Solver.CommutativeMonoid.html#4202" class="Bound">e₁</a> <a id="4226" href="Algebra.Solver.CommutativeMonoid.html#2484" class="Function Operator">•</a> <a id="4228" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4238" href="Algebra.Solver.CommutativeMonoid.html#4207" class="Bound">e₂</a>

<a id="4242" class="Comment">-- The normaliser preserves the semantics of the expression.</a>

<a id="normalise-correct"></a><a id="4304" href="Algebra.Solver.CommutativeMonoid.html#4304" class="Function">normalise-correct</a> <a id="4322" class="Symbol">:</a> <a id="4324" class="Symbol">∀</a> <a id="4326" class="Symbol">{</a><a id="4327" href="Algebra.Solver.CommutativeMonoid.html#4327" class="Bound">n</a><a id="4328" class="Symbol">}</a> <a id="4330" class="Symbol">(</a><a id="4331" href="Algebra.Solver.CommutativeMonoid.html#4331" class="Bound">e</a> <a id="4333" class="Symbol">:</a> <a id="4335" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="4340" href="Algebra.Solver.CommutativeMonoid.html#4327" class="Bound">n</a><a id="4341" class="Symbol">)</a> <a id="4343" class="Symbol">(</a><a id="4344" href="Algebra.Solver.CommutativeMonoid.html#4344" class="Bound">ρ</a> <a id="4346" class="Symbol">:</a> <a id="4348" href="Algebra.Solver.CommutativeMonoid.html#1599" class="Function">Env</a> <a id="4352" href="Algebra.Solver.CommutativeMonoid.html#4327" class="Bound">n</a><a id="4353" class="Symbol">)</a> <a id="4355" class="Symbol">→</a>
    <a id="4361" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="4363" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4373" href="Algebra.Solver.CommutativeMonoid.html#4331" class="Bound">e</a> <a id="4375" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="4378" href="Algebra.Solver.CommutativeMonoid.html#4344" class="Bound">ρ</a> <a id="4380" href="Algebra.Bundles.html#6726" class="Field Operator">≈</a> <a id="4382" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="4384" href="Algebra.Solver.CommutativeMonoid.html#4331" class="Bound">e</a> <a id="4386" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="4388" href="Algebra.Solver.CommutativeMonoid.html#4344" class="Bound">ρ</a>
<a id="4390" href="Algebra.Solver.CommutativeMonoid.html#4304" class="Function">normalise-correct</a> <a id="4408" class="Symbol">(</a><a id="4409" href="Algebra.Solver.CommutativeMonoid.html#1471" class="InductiveConstructor">var</a> <a id="4413" href="Algebra.Solver.CommutativeMonoid.html#4413" class="Bound">x</a><a id="4414" class="Symbol">)</a>   <a id="4418" href="Algebra.Solver.CommutativeMonoid.html#4418" class="Bound">ρ</a> <a id="4420" class="Symbol">=</a> <a id="4422" href="Algebra.Solver.CommutativeMonoid.html#2918" class="Function">sg-correct</a> <a id="4433" href="Algebra.Solver.CommutativeMonoid.html#4413" class="Bound">x</a> <a id="4435" href="Algebra.Solver.CommutativeMonoid.html#4418" class="Bound">ρ</a>
<a id="4437" href="Algebra.Solver.CommutativeMonoid.html#4304" class="Function">normalise-correct</a> <a id="4455" href="Algebra.Solver.CommutativeMonoid.html#1494" class="InductiveConstructor">id</a>        <a id="4465" href="Algebra.Solver.CommutativeMonoid.html#4465" class="Bound">ρ</a> <a id="4467" class="Symbol">=</a> <a id="4469" href="Algebra.Solver.CommutativeMonoid.html#2749" class="Function">empty-correct</a> <a id="4483" href="Algebra.Solver.CommutativeMonoid.html#4465" class="Bound">ρ</a>
<a id="4485" href="Algebra.Solver.CommutativeMonoid.html#4304" class="Function">normalise-correct</a> <a id="4503" class="Symbol">(</a><a id="4504" href="Algebra.Solver.CommutativeMonoid.html#4504" class="Bound">e₁</a> <a id="4507" href="Algebra.Solver.CommutativeMonoid.html#1509" class="InductiveConstructor Operator">⊕</a> <a id="4509" href="Algebra.Solver.CommutativeMonoid.html#4509" class="Bound">e₂</a><a id="4511" class="Symbol">)</a> <a id="4513" href="Algebra.Solver.CommutativeMonoid.html#4513" class="Bound">ρ</a> <a id="4515" class="Symbol">=</a>  <a id="4518" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>

    <a id="4529" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="4531" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4541" href="Algebra.Solver.CommutativeMonoid.html#4504" class="Bound">e₁</a> <a id="4544" href="Algebra.Solver.CommutativeMonoid.html#2484" class="Function Operator">•</a> <a id="4546" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4556" href="Algebra.Solver.CommutativeMonoid.html#4509" class="Bound">e₂</a> <a id="4559" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="4562" href="Algebra.Solver.CommutativeMonoid.html#4513" class="Bound">ρ</a>

  <a id="4567" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">≈⟨</a> <a id="4570" href="Algebra.Solver.CommutativeMonoid.html#3258" class="Function">comp-correct</a> <a id="4583" class="Symbol">(</a><a id="4584" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4594" href="Algebra.Solver.CommutativeMonoid.html#4504" class="Bound">e₁</a><a id="4596" class="Symbol">)</a> <a id="4598" class="Symbol">(</a><a id="4599" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4609" href="Algebra.Solver.CommutativeMonoid.html#4509" class="Bound">e₂</a><a id="4611" class="Symbol">)</a> <a id="4613" href="Algebra.Solver.CommutativeMonoid.html#4513" class="Bound">ρ</a> <a id="4615" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">⟩</a>

    <a id="4622" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="4624" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4634" href="Algebra.Solver.CommutativeMonoid.html#4504" class="Bound">e₁</a> <a id="4637" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="4640" href="Algebra.Solver.CommutativeMonoid.html#4513" class="Bound">ρ</a> <a id="4642" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="4644" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="4646" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="4656" href="Algebra.Solver.CommutativeMonoid.html#4509" class="Bound">e₂</a> <a id="4659" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="4662" href="Algebra.Solver.CommutativeMonoid.html#4513" class="Bound">ρ</a>

  <a id="4667" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">≈⟨</a> <a id="4670" href="Algebra.Structures.html#1315" class="Function">∙-cong</a> <a id="4677" class="Symbol">(</a><a id="4678" href="Algebra.Solver.CommutativeMonoid.html#4304" class="Function">normalise-correct</a> <a id="4696" href="Algebra.Solver.CommutativeMonoid.html#4504" class="Bound">e₁</a> <a id="4699" href="Algebra.Solver.CommutativeMonoid.html#4513" class="Bound">ρ</a><a id="4700" class="Symbol">)</a> <a id="4702" class="Symbol">(</a><a id="4703" href="Algebra.Solver.CommutativeMonoid.html#4304" class="Function">normalise-correct</a> <a id="4721" href="Algebra.Solver.CommutativeMonoid.html#4509" class="Bound">e₂</a> <a id="4724" href="Algebra.Solver.CommutativeMonoid.html#4513" class="Bound">ρ</a><a id="4725" class="Symbol">)</a> <a id="4727" href="Relation.Binary.Reasoning.Setoid.html#985" class="Function">⟩</a>

    <a id="4734" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="4736" href="Algebra.Solver.CommutativeMonoid.html#4504" class="Bound">e₁</a> <a id="4739" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="4741" href="Algebra.Solver.CommutativeMonoid.html#4513" class="Bound">ρ</a> <a id="4743" href="Algebra.Bundles.html#6766" class="Field Operator">∙</a> <a id="4745" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="4747" href="Algebra.Solver.CommutativeMonoid.html#4509" class="Bound">e₂</a> <a id="4750" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="4752" href="Algebra.Solver.CommutativeMonoid.html#4513" class="Bound">ρ</a>
  <a id="4756" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a>

<a id="4759" class="Comment">------------------------------------------------------------------------</a>
<a id="4832" class="Comment">-- &quot;Tactic.</a>

<a id="4845" class="Keyword">open</a> <a id="4850" class="Keyword">module</a> <a id="R"></a><a id="4857" href="Algebra.Solver.CommutativeMonoid.html#4857" class="Module">R</a> <a id="4859" class="Symbol">=</a> <a id="4861" href="Relation.Binary.Reflection.html" class="Module">Reflection</a>
                  <a id="4890" href="Algebra.Structures.html#1390" class="Function">setoid</a> <a id="4897" href="Algebra.Solver.CommutativeMonoid.html#1471" class="InductiveConstructor">var</a> <a id="4901" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦_⟧</a> <a id="4905" class="Symbol">(</a><a id="4906" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦_⟧⇓</a> <a id="4911" href="Function.Base.html#1115" class="Function Operator">∘</a> <a id="4913" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a><a id="4922" class="Symbol">)</a> <a id="4924" href="Algebra.Solver.CommutativeMonoid.html#4304" class="Function">normalise-correct</a>
  <a id="4944" class="Keyword">public</a> <a id="4951" class="Keyword">using</a> <a id="4957" class="Symbol">(</a><a id="4958" href="Relation.Binary.Reflection.html#2519" class="Function">solve</a><a id="4963" class="Symbol">;</a> <a id="4965" href="Relation.Binary.Reflection.html#3624" class="Function Operator">_⊜_</a><a id="4968" class="Symbol">)</a>

<a id="4971" class="Comment">-- We can decide if two normal forms are /syntactically/ equal.</a>

<a id="5036" class="Keyword">infix</a> <a id="5042" class="Number">5</a> <a id="5044" href="Algebra.Solver.CommutativeMonoid.html#5049" class="Function Operator">_≟_</a>

<a id="_≟_"></a><a id="5049" href="Algebra.Solver.CommutativeMonoid.html#5049" class="Function Operator">_≟_</a> <a id="5053" class="Symbol">:</a> <a id="5055" class="Symbol">∀</a> <a id="5057" class="Symbol">{</a><a id="5058" href="Algebra.Solver.CommutativeMonoid.html#5058" class="Bound">n</a><a id="5059" class="Symbol">}</a> <a id="5061" class="Symbol">(</a><a id="5062" href="Algebra.Solver.CommutativeMonoid.html#5062" class="Bound">nf₁</a> <a id="5066" href="Algebra.Solver.CommutativeMonoid.html#5066" class="Bound">nf₂</a> <a id="5070" class="Symbol">:</a> <a id="5072" href="Algebra.Solver.CommutativeMonoid.html#1990" class="Function">Normal</a> <a id="5079" href="Algebra.Solver.CommutativeMonoid.html#5058" class="Bound">n</a><a id="5080" class="Symbol">)</a> <a id="5082" class="Symbol">→</a> <a id="5084" href="Relation.Nullary.Decidable.Core.html#1490" class="Record">Dec</a> <a id="5088" class="Symbol">(</a><a id="5089" href="Algebra.Solver.CommutativeMonoid.html#5062" class="Bound">nf₁</a> <a id="5093" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="5095" href="Algebra.Solver.CommutativeMonoid.html#5066" class="Bound">nf₂</a><a id="5098" class="Symbol">)</a>
<a id="5100" href="Algebra.Solver.CommutativeMonoid.html#5100" class="Bound">nf₁</a> <a id="5104" href="Algebra.Solver.CommutativeMonoid.html#5049" class="Function Operator">≟</a> <a id="5106" href="Algebra.Solver.CommutativeMonoid.html#5106" class="Bound">nf₂</a> <a id="5110" class="Symbol">=</a> <a id="5112" href="Relation.Nullary.Decidable.html#1305" class="Function">Dec.map</a> <a id="5120" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#9465" class="Function">Pointwise-≡↔≡</a> <a id="5134" class="Symbol">(</a><a id="5135" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html#3483" class="Function">decidable</a> <a id="5145" href="Data.Nat.Properties.html#2947" class="Function Operator">ℕ._≟_</a> <a id="5151" href="Algebra.Solver.CommutativeMonoid.html#5100" class="Bound">nf₁</a> <a id="5155" href="Algebra.Solver.CommutativeMonoid.html#5106" class="Bound">nf₂</a><a id="5158" class="Symbol">)</a>
  <a id="5162" class="Keyword">where</a> <a id="5168" class="Keyword">open</a> <a id="5173" href="Data.Vec.Relation.Binary.Pointwise.Inductive.html" class="Module">Pointwise</a>

<a id="5184" class="Comment">-- We can also give a sound, but not necessarily complete, procedure</a>
<a id="5253" class="Comment">-- for determining if two expressions have the same semantics.</a>

<a id="prove′"></a><a id="5317" href="Algebra.Solver.CommutativeMonoid.html#5317" class="Function">prove′</a> <a id="5324" class="Symbol">:</a> <a id="5326" class="Symbol">∀</a> <a id="5328" class="Symbol">{</a><a id="5329" href="Algebra.Solver.CommutativeMonoid.html#5329" class="Bound">n</a><a id="5330" class="Symbol">}</a> <a id="5332" class="Symbol">(</a><a id="5333" href="Algebra.Solver.CommutativeMonoid.html#5333" class="Bound">e₁</a> <a id="5336" href="Algebra.Solver.CommutativeMonoid.html#5336" class="Bound">e₂</a> <a id="5339" class="Symbol">:</a> <a id="5341" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="5346" href="Algebra.Solver.CommutativeMonoid.html#5329" class="Bound">n</a><a id="5347" class="Symbol">)</a> <a id="5349" class="Symbol">→</a> <a id="5351" href="Agda.Builtin.Maybe.html#118" class="Datatype">Maybe</a> <a id="5357" class="Symbol">(∀</a> <a id="5360" href="Algebra.Solver.CommutativeMonoid.html#5360" class="Bound">ρ</a> <a id="5362" class="Symbol">→</a> <a id="5364" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="5366" href="Algebra.Solver.CommutativeMonoid.html#5333" class="Bound">e₁</a> <a id="5369" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="5371" href="Algebra.Solver.CommutativeMonoid.html#5360" class="Bound">ρ</a> <a id="5373" href="Algebra.Bundles.html#6726" class="Field Operator">≈</a> <a id="5375" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="5377" href="Algebra.Solver.CommutativeMonoid.html#5336" class="Bound">e₂</a> <a id="5380" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="5382" href="Algebra.Solver.CommutativeMonoid.html#5360" class="Bound">ρ</a><a id="5383" class="Symbol">)</a>
<a id="5385" href="Algebra.Solver.CommutativeMonoid.html#5317" class="Function">prove′</a> <a id="5392" href="Algebra.Solver.CommutativeMonoid.html#5392" class="Bound">e₁</a> <a id="5395" href="Algebra.Solver.CommutativeMonoid.html#5395" class="Bound">e₂</a> <a id="5398" class="Symbol">=</a>
  <a id="5402" href="Data.Maybe.Base.html#2049" class="Function">Maybe.map</a> <a id="5412" href="Algebra.Solver.CommutativeMonoid.html#5471" class="Function">lemma</a> <a id="5418" class="Symbol">(</a><a id="5419" href="Data.Maybe.Base.html#1241" class="Function">decToMaybe</a> <a id="5430" class="Symbol">(</a><a id="5431" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="5441" href="Algebra.Solver.CommutativeMonoid.html#5392" class="Bound">e₁</a> <a id="5444" href="Algebra.Solver.CommutativeMonoid.html#5049" class="Function Operator">≟</a> <a id="5446" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="5456" href="Algebra.Solver.CommutativeMonoid.html#5395" class="Bound">e₂</a><a id="5458" class="Symbol">))</a>
  <a id="5463" class="Keyword">where</a>
  <a id="5471" href="Algebra.Solver.CommutativeMonoid.html#5471" class="Function">lemma</a> <a id="5477" class="Symbol">:</a> <a id="5479" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="5489" href="Algebra.Solver.CommutativeMonoid.html#5392" class="Bound">e₁</a> <a id="5492" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="5494" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="5504" href="Algebra.Solver.CommutativeMonoid.html#5395" class="Bound">e₂</a> <a id="5507" class="Symbol">→</a> <a id="5509" class="Symbol">∀</a> <a id="5511" href="Algebra.Solver.CommutativeMonoid.html#5511" class="Bound">ρ</a> <a id="5513" class="Symbol">→</a> <a id="5515" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="5517" href="Algebra.Solver.CommutativeMonoid.html#5392" class="Bound">e₁</a> <a id="5520" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="5522" href="Algebra.Solver.CommutativeMonoid.html#5511" class="Bound">ρ</a> <a id="5524" href="Algebra.Bundles.html#6726" class="Field Operator">≈</a> <a id="5526" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟦</a> <a id="5528" href="Algebra.Solver.CommutativeMonoid.html#5395" class="Bound">e₂</a> <a id="5531" href="Algebra.Solver.CommutativeMonoid.html#1722" class="Function Operator">⟧</a> <a id="5533" href="Algebra.Solver.CommutativeMonoid.html#5511" class="Bound">ρ</a>
  <a id="5537" href="Algebra.Solver.CommutativeMonoid.html#5471" class="Function">lemma</a> <a id="5543" href="Algebra.Solver.CommutativeMonoid.html#5543" class="Bound">eq</a> <a id="5546" href="Algebra.Solver.CommutativeMonoid.html#5546" class="Bound">ρ</a> <a id="5548" class="Symbol">=</a>
    <a id="5554" href="Relation.Binary.Reflection.html#1833" class="Function">R.prove</a> <a id="5562" href="Algebra.Solver.CommutativeMonoid.html#5546" class="Bound">ρ</a> <a id="5564" href="Algebra.Solver.CommutativeMonoid.html#5392" class="Bound">e₁</a> <a id="5567" href="Algebra.Solver.CommutativeMonoid.html#5395" class="Bound">e₂</a> <a id="5570" class="Symbol">(</a><a id="5571" href="Relation.Binary.Reasoning.Base.Single.html#1925" class="Function Operator">begin</a>
      <a id="5583" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="5585" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="5595" href="Algebra.Solver.CommutativeMonoid.html#5392" class="Bound">e₁</a> <a id="5598" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="5601" href="Algebra.Solver.CommutativeMonoid.html#5546" class="Bound">ρ</a>  <a id="5604" href="Relation.Binary.Reasoning.Base.Single.html#2191" class="Function">≡⟨</a> <a id="5607" href="Relation.Binary.PropositionalEquality.Core.html#1158" class="Function">P.cong</a> <a id="5614" class="Symbol">(λ</a> <a id="5617" href="Algebra.Solver.CommutativeMonoid.html#5617" class="Bound">e</a> <a id="5619" class="Symbol">→</a> <a id="5621" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="5623" href="Algebra.Solver.CommutativeMonoid.html#5617" class="Bound">e</a> <a id="5625" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="5628" href="Algebra.Solver.CommutativeMonoid.html#5546" class="Bound">ρ</a><a id="5629" class="Symbol">)</a> <a id="5631" href="Algebra.Solver.CommutativeMonoid.html#5543" class="Bound">eq</a> <a id="5634" href="Relation.Binary.Reasoning.Base.Single.html#2191" class="Function">⟩</a>
      <a id="5642" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟦</a> <a id="5644" href="Algebra.Solver.CommutativeMonoid.html#4098" class="Function">normalise</a> <a id="5654" href="Algebra.Solver.CommutativeMonoid.html#5395" class="Bound">e₂</a> <a id="5657" href="Algebra.Solver.CommutativeMonoid.html#2063" class="Function Operator">⟧⇓</a> <a id="5660" href="Algebra.Solver.CommutativeMonoid.html#5546" class="Bound">ρ</a>  <a id="5663" href="Relation.Binary.Reasoning.Base.Single.html#2564" class="Function Operator">∎</a><a id="5664" class="Symbol">)</a>

<a id="5667" class="Comment">-- This procedure can be combined with from-just.</a>

<a id="prove"></a><a id="5718" href="Algebra.Solver.CommutativeMonoid.html#5718" class="Function">prove</a> <a id="5724" class="Symbol">:</a> <a id="5726" class="Symbol">∀</a> <a id="5728" href="Algebra.Solver.CommutativeMonoid.html#5728" class="Bound">n</a> <a id="5730" class="Symbol">(</a><a id="5731" href="Algebra.Solver.CommutativeMonoid.html#5731" class="Bound">e₁</a> <a id="5734" href="Algebra.Solver.CommutativeMonoid.html#5734" class="Bound">e₂</a> <a id="5737" class="Symbol">:</a> <a id="5739" href="Algebra.Solver.CommutativeMonoid.html#1444" class="Datatype">Expr</a> <a id="5744" href="Algebra.Solver.CommutativeMonoid.html#5728" class="Bound">n</a><a id="5745" class="Symbol">)</a> <a id="5747" class="Symbol">→</a> <a id="5749" href="Data.Maybe.Base.html#1847" class="Function">From-just</a> <a id="5759" class="Symbol">(</a><a id="5760" href="Algebra.Solver.CommutativeMonoid.html#5317" class="Function">prove′</a> <a id="5767" href="Algebra.Solver.CommutativeMonoid.html#5731" class="Bound">e₁</a> <a id="5770" href="Algebra.Solver.CommutativeMonoid.html#5734" class="Bound">e₂</a><a id="5772" class="Symbol">)</a>
<a id="5774" href="Algebra.Solver.CommutativeMonoid.html#5718" class="Function">prove</a> <a id="5780" class="Symbol">_</a> <a id="5782" href="Algebra.Solver.CommutativeMonoid.html#5782" class="Bound">e₁</a> <a id="5785" href="Algebra.Solver.CommutativeMonoid.html#5785" class="Bound">e₂</a> <a id="5788" class="Symbol">=</a> <a id="5790" href="Data.Maybe.Base.html#1935" class="Function">from-just</a> <a id="5800" class="Symbol">(</a><a id="5801" href="Algebra.Solver.CommutativeMonoid.html#5317" class="Function">prove′</a> <a id="5808" href="Algebra.Solver.CommutativeMonoid.html#5782" class="Bound">e₁</a> <a id="5811" href="Algebra.Solver.CommutativeMonoid.html#5785" class="Bound">e₂</a><a id="5813" class="Symbol">)</a>

<a id="5816" class="Comment">-- prove : ∀ n (es : Expr n × Expr n) →</a>
<a id="5856" class="Comment">--         From-just (uncurry prove′ es)</a>
<a id="5897" class="Comment">-- prove _ = from-just ∘ uncurry prove′</a>
</pre></body></html>