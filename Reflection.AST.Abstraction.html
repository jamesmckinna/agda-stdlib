<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Reflection.AST.Abstraction</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Comment">------------------------------------------------------------------------</a>
<a id="74" class="Comment">-- The Agda standard library</a>
<a id="103" class="Comment">--</a>
<a id="106" class="Comment">-- Abstractions used in the reflection machinery</a>
<a id="155" class="Comment">------------------------------------------------------------------------</a>

<a id="229" class="Symbol">{-#</a> <a id="233" class="Keyword">OPTIONS</a> <a id="241" class="Pragma">--cubical-compatible</a> <a id="262" class="Pragma">--safe</a> <a id="269" class="Symbol">#-}</a>

<a id="274" class="Keyword">module</a> <a id="281" href="Reflection.AST.Abstraction.html" class="Module">Reflection.AST.Abstraction</a> <a id="308" class="Keyword">where</a>

<a id="315" class="Keyword">open</a> <a id="320" class="Keyword">import</a> <a id="327" href="Data.String.Base.html" class="Module">Data.String.Base</a> <a id="344" class="Symbol">as</a> <a id="347" class="Module">String</a>                 <a id="370" class="Keyword">using</a> <a id="376" class="Symbol">(</a><a id="377" href="Agda.Builtin.String.html#318" class="Postulate">String</a><a id="383" class="Symbol">)</a>
<a id="385" class="Keyword">open</a> <a id="390" class="Keyword">import</a> <a id="397" href="Data.String.Properties.html" class="Module">Data.String.Properties</a> <a id="420" class="Symbol">as</a> <a id="423" class="Module">String</a>           <a id="440" class="Keyword">using</a> <a id="446" class="Symbol">(</a><a id="447" href="Data.String.Properties.html#2306" class="Function Operator">_≟_</a><a id="450" class="Symbol">)</a>
<a id="452" class="Keyword">open</a> <a id="457" class="Keyword">import</a> <a id="464" href="Data.Product.Base.html" class="Module">Data.Product.Base</a>                          <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Data.Product.Base.html#1618" class="Function Operator">_×_</a><a id="517" class="Symbol">;</a> <a id="519" href="Data.Product.Base.html#2000" class="Function Operator">&lt;_,_&gt;</a><a id="524" class="Symbol">;</a> <a id="526" href="Data.Product.Base.html#3109" class="Function">uncurry</a><a id="533" class="Symbol">)</a>
<a id="535" class="Keyword">open</a> <a id="540" class="Keyword">import</a> <a id="547" href="Level.html" class="Module">Level</a>
<a id="553" class="Keyword">open</a> <a id="558" class="Keyword">import</a> <a id="565" href="Relation.Nullary.Decidable.html" class="Module">Relation.Nullary.Decidable</a>                 <a id="608" class="Keyword">using</a> <a id="614" class="Symbol">(</a><a id="615" href="Relation.Nullary.Decidable.Core.html#1490" class="Record">Dec</a><a id="618" class="Symbol">;</a> <a id="620" href="Relation.Nullary.Decidable.Core.html#4796" class="Function">map′</a><a id="624" class="Symbol">;</a> <a id="626" href="Relation.Nullary.Decidable.Core.html#2269" class="Function Operator">_×-dec_</a><a id="633" class="Symbol">)</a>
<a id="635" class="Keyword">open</a> <a id="640" class="Keyword">import</a> <a id="647" href="Relation.Binary.Definitions.html" class="Module">Relation.Binary.Definitions</a>                <a id="690" class="Keyword">using</a> <a id="696" class="Symbol">(</a><a id="697" href="Relation.Binary.Definitions.html#6222" class="Function">DecidableEquality</a><a id="714" class="Symbol">)</a>
<a id="716" class="Keyword">open</a> <a id="721" class="Keyword">import</a> <a id="728" href="Relation.Binary.PropositionalEquality.Core.html" class="Module">Relation.Binary.PropositionalEquality.Core</a> <a id="771" class="Keyword">using</a> <a id="777" class="Symbol">(</a><a id="778" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">_≡_</a><a id="781" class="Symbol">;</a> <a id="783" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a><a id="787" class="Symbol">;</a> <a id="789" href="Relation.Binary.PropositionalEquality.Core.html#1395" class="Function">cong₂</a><a id="794" class="Symbol">)</a>

<a id="797" class="Keyword">private</a>
  <a id="807" class="Keyword">variable</a>
    <a id="820" href="Reflection.AST.Abstraction.html#820" class="Generalizable">a</a> <a id="822" href="Reflection.AST.Abstraction.html#822" class="Generalizable">b</a> <a id="824" class="Symbol">:</a> <a id="826" href="Agda.Primitive.html#591" class="Postulate">Level</a>
    <a id="836" href="Reflection.AST.Abstraction.html#836" class="Generalizable">A</a> <a id="838" href="Reflection.AST.Abstraction.html#838" class="Generalizable">B</a> <a id="840" class="Symbol">:</a> <a id="842" href="Agda.Primitive.html#320" class="Primitive">Set</a> <a id="846" href="Reflection.AST.Abstraction.html#820" class="Generalizable">a</a>
    <a id="852" href="Reflection.AST.Abstraction.html#852" class="Generalizable">s</a> <a id="854" href="Reflection.AST.Abstraction.html#854" class="Generalizable">t</a> <a id="856" class="Symbol">:</a> <a id="858" href="Agda.Builtin.String.html#318" class="Postulate">String</a>
    <a id="869" href="Reflection.AST.Abstraction.html#869" class="Generalizable">x</a> <a id="871" href="Reflection.AST.Abstraction.html#871" class="Generalizable">y</a> <a id="873" class="Symbol">:</a> <a id="875" href="Reflection.AST.Abstraction.html#836" class="Generalizable">A</a>

<a id="878" class="Comment">------------------------------------------------------------------------</a>
<a id="951" class="Comment">-- Re-exporting the builtins publicly</a>

<a id="990" class="Keyword">open</a> <a id="995" class="Keyword">import</a> <a id="1002" href="Agda.Builtin.Reflection.html" class="Module">Agda.Builtin.Reflection</a> <a id="1026" class="Keyword">public</a>
  <a id="1035" class="Keyword">using</a> <a id="1041" class="Symbol">(</a><a id="1042" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a><a id="1045" class="Symbol">)</a>

<a id="1048" class="Keyword">open</a> <a id="1053" href="Agda.Builtin.Reflection.html#3926" class="Module">Abs</a> <a id="1057" class="Keyword">public</a>

<a id="1065" class="Comment">------------------------------------------------------------------------</a>
<a id="1138" class="Comment">-- Operations</a>

<a id="map"></a><a id="1153" href="Reflection.AST.Abstraction.html#1153" class="Function">map</a> <a id="1157" class="Symbol">:</a> <a id="1159" class="Symbol">(</a><a id="1160" href="Reflection.AST.Abstraction.html#836" class="Generalizable">A</a> <a id="1162" class="Symbol">→</a> <a id="1164" href="Reflection.AST.Abstraction.html#838" class="Generalizable">B</a><a id="1165" class="Symbol">)</a> <a id="1167" class="Symbol">→</a> <a id="1169" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1173" href="Reflection.AST.Abstraction.html#836" class="Generalizable">A</a> <a id="1175" class="Symbol">→</a> <a id="1177" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1181" href="Reflection.AST.Abstraction.html#838" class="Generalizable">B</a>
<a id="1183" href="Reflection.AST.Abstraction.html#1153" class="Function">map</a> <a id="1187" href="Reflection.AST.Abstraction.html#1187" class="Bound">f</a> <a id="1189" class="Symbol">(</a><a id="1190" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1194" href="Reflection.AST.Abstraction.html#1194" class="Bound">s</a> <a id="1196" href="Reflection.AST.Abstraction.html#1196" class="Bound">x</a><a id="1197" class="Symbol">)</a> <a id="1199" class="Symbol">=</a> <a id="1201" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1205" href="Reflection.AST.Abstraction.html#1194" class="Bound">s</a> <a id="1207" class="Symbol">(</a><a id="1208" href="Reflection.AST.Abstraction.html#1187" class="Bound">f</a> <a id="1210" href="Reflection.AST.Abstraction.html#1196" class="Bound">x</a><a id="1211" class="Symbol">)</a>

<a id="1214" class="Comment">------------------------------------------------------------------------</a>
<a id="1287" class="Comment">-- Decidable equality</a>

<a id="abs-injective₁"></a><a id="1310" href="Reflection.AST.Abstraction.html#1310" class="Function">abs-injective₁</a> <a id="1325" class="Symbol">:</a> <a id="1327" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1331" href="Reflection.AST.Abstraction.html#852" class="Generalizable">s</a> <a id="1333" href="Reflection.AST.Abstraction.html#869" class="Generalizable">x</a> <a id="1335" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1337" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1341" href="Reflection.AST.Abstraction.html#854" class="Generalizable">t</a> <a id="1343" href="Reflection.AST.Abstraction.html#871" class="Generalizable">y</a> <a id="1345" class="Symbol">→</a> <a id="1347" href="Reflection.AST.Abstraction.html#852" class="Generalizable">s</a> <a id="1349" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1351" href="Reflection.AST.Abstraction.html#854" class="Generalizable">t</a>
<a id="1353" href="Reflection.AST.Abstraction.html#1310" class="Function">abs-injective₁</a> <a id="1368" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="1373" class="Symbol">=</a> <a id="1375" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="abs-injective₂"></a><a id="1381" href="Reflection.AST.Abstraction.html#1381" class="Function">abs-injective₂</a> <a id="1396" class="Symbol">:</a> <a id="1398" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1402" href="Reflection.AST.Abstraction.html#852" class="Generalizable">s</a> <a id="1404" href="Reflection.AST.Abstraction.html#869" class="Generalizable">x</a> <a id="1406" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1408" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1412" href="Reflection.AST.Abstraction.html#854" class="Generalizable">t</a> <a id="1414" href="Reflection.AST.Abstraction.html#871" class="Generalizable">y</a> <a id="1416" class="Symbol">→</a> <a id="1418" href="Reflection.AST.Abstraction.html#869" class="Generalizable">x</a> <a id="1420" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1422" href="Reflection.AST.Abstraction.html#871" class="Generalizable">y</a>
<a id="1424" href="Reflection.AST.Abstraction.html#1381" class="Function">abs-injective₂</a> <a id="1439" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a> <a id="1444" class="Symbol">=</a> <a id="1446" href="Agda.Builtin.Equality.html#190" class="InductiveConstructor">refl</a>

<a id="abs-injective"></a><a id="1452" href="Reflection.AST.Abstraction.html#1452" class="Function">abs-injective</a> <a id="1466" class="Symbol">:</a> <a id="1468" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1472" href="Reflection.AST.Abstraction.html#852" class="Generalizable">s</a> <a id="1474" href="Reflection.AST.Abstraction.html#869" class="Generalizable">x</a> <a id="1476" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1478" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1482" href="Reflection.AST.Abstraction.html#854" class="Generalizable">t</a> <a id="1484" href="Reflection.AST.Abstraction.html#871" class="Generalizable">y</a> <a id="1486" class="Symbol">→</a> <a id="1488" href="Reflection.AST.Abstraction.html#852" class="Generalizable">s</a> <a id="1490" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1492" href="Reflection.AST.Abstraction.html#854" class="Generalizable">t</a> <a id="1494" href="Data.Product.Base.html#1618" class="Function Operator">×</a> <a id="1496" href="Reflection.AST.Abstraction.html#869" class="Generalizable">x</a> <a id="1498" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1500" href="Reflection.AST.Abstraction.html#871" class="Generalizable">y</a>
<a id="1502" href="Reflection.AST.Abstraction.html#1452" class="Function">abs-injective</a> <a id="1516" class="Symbol">=</a> <a id="1518" href="Data.Product.Base.html#2000" class="Function Operator">&lt;</a> <a id="1520" href="Reflection.AST.Abstraction.html#1310" class="Function">abs-injective₁</a> <a id="1535" href="Data.Product.Base.html#2000" class="Function Operator">,</a> <a id="1537" href="Reflection.AST.Abstraction.html#1381" class="Function">abs-injective₂</a> <a id="1552" href="Data.Product.Base.html#2000" class="Function Operator">&gt;</a>

<a id="1555" class="Comment">-- We often need decidability of equality for Abs A when implementing it</a>
<a id="1628" class="Comment">-- for A. Unfortunately ≡-dec makes the termination checker unhappy.</a>
<a id="1697" class="Comment">-- Instead, we can match on both Abs A and use unAbs-dec for an</a>
<a id="1761" class="Comment">-- obviously decreasing recursive call.</a>

<a id="unAbs"></a><a id="1802" href="Reflection.AST.Abstraction.html#1802" class="Function">unAbs</a> <a id="1808" class="Symbol">:</a> <a id="1810" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1814" href="Reflection.AST.Abstraction.html#836" class="Generalizable">A</a> <a id="1816" class="Symbol">→</a> <a id="1818" href="Reflection.AST.Abstraction.html#836" class="Generalizable">A</a>
<a id="1820" href="Reflection.AST.Abstraction.html#1802" class="Function">unAbs</a> <a id="1826" class="Symbol">(</a><a id="1827" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1831" href="Reflection.AST.Abstraction.html#1831" class="Bound">s</a> <a id="1833" href="Reflection.AST.Abstraction.html#1833" class="Bound">a</a><a id="1834" class="Symbol">)</a> <a id="1836" class="Symbol">=</a> <a id="1838" href="Reflection.AST.Abstraction.html#1833" class="Bound">a</a>

<a id="unAbs-dec"></a><a id="1841" href="Reflection.AST.Abstraction.html#1841" class="Function">unAbs-dec</a> <a id="1851" class="Symbol">:</a> <a id="1853" class="Symbol">{</a><a id="1854" href="Reflection.AST.Abstraction.html#1854" class="Bound">abs1</a> <a id="1859" href="Reflection.AST.Abstraction.html#1859" class="Bound">abs2</a> <a id="1864" class="Symbol">:</a> <a id="1866" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="1870" href="Reflection.AST.Abstraction.html#836" class="Generalizable">A</a><a id="1871" class="Symbol">}</a> <a id="1873" class="Symbol">→</a> <a id="1875" href="Relation.Nullary.Decidable.Core.html#1490" class="Record">Dec</a> <a id="1879" class="Symbol">(</a><a id="1880" href="Reflection.AST.Abstraction.html#1802" class="Function">unAbs</a> <a id="1886" href="Reflection.AST.Abstraction.html#1854" class="Bound">abs1</a> <a id="1891" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1893" href="Reflection.AST.Abstraction.html#1802" class="Function">unAbs</a> <a id="1899" href="Reflection.AST.Abstraction.html#1859" class="Bound">abs2</a><a id="1903" class="Symbol">)</a> <a id="1905" class="Symbol">→</a> <a id="1907" href="Relation.Nullary.Decidable.Core.html#1490" class="Record">Dec</a> <a id="1911" class="Symbol">(</a><a id="1912" href="Reflection.AST.Abstraction.html#1854" class="Bound">abs1</a> <a id="1917" href="Agda.Builtin.Equality.html#133" class="Datatype Operator">≡</a> <a id="1919" href="Reflection.AST.Abstraction.html#1859" class="Bound">abs2</a><a id="1923" class="Symbol">)</a>
<a id="1925" href="Reflection.AST.Abstraction.html#1841" class="Function">unAbs-dec</a> <a id="1935" class="Symbol">{</a><a id="1936" class="Argument">abs1</a> <a id="1941" class="Symbol">=</a> <a id="1943" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1947" href="Reflection.AST.Abstraction.html#1947" class="Bound">s</a> <a id="1949" href="Reflection.AST.Abstraction.html#1949" class="Bound">a</a><a id="1950" class="Symbol">}</a> <a id="1952" class="Symbol">{</a><a id="1953" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a> <a id="1957" href="Reflection.AST.Abstraction.html#1957" class="Bound">t</a> <a id="1959" href="Reflection.AST.Abstraction.html#1959" class="Bound">a′</a><a id="1961" class="Symbol">}</a> <a id="1963" href="Reflection.AST.Abstraction.html#1963" class="Bound">a≟a′</a> <a id="1968" class="Symbol">=</a>
  <a id="1972" href="Relation.Nullary.Decidable.Core.html#4796" class="Function">map′</a> <a id="1977" class="Symbol">(</a><a id="1978" href="Data.Product.Base.html#3109" class="Function">uncurry</a> <a id="1986" class="Symbol">(</a><a id="1987" href="Relation.Binary.PropositionalEquality.Core.html#1395" class="Function">cong₂</a> <a id="1993" href="Agda.Builtin.Reflection.html#3962" class="InductiveConstructor">abs</a><a id="1996" class="Symbol">))</a> <a id="1999" href="Reflection.AST.Abstraction.html#1452" class="Function">abs-injective</a> <a id="2013" class="Symbol">(</a><a id="2014" href="Reflection.AST.Abstraction.html#1947" class="Bound">s</a> <a id="2016" href="Data.String.Properties.html#2306" class="Function Operator">String.≟</a> <a id="2025" href="Reflection.AST.Abstraction.html#1957" class="Bound">t</a> <a id="2027" href="Relation.Nullary.Decidable.Core.html#2269" class="Function Operator">×-dec</a> <a id="2033" href="Reflection.AST.Abstraction.html#1963" class="Bound">a≟a′</a><a id="2037" class="Symbol">)</a>

<a id="≡-dec"></a><a id="2040" href="Reflection.AST.Abstraction.html#2040" class="Function">≡-dec</a> <a id="2046" class="Symbol">:</a> <a id="2048" href="Relation.Binary.Definitions.html#6222" class="Function">DecidableEquality</a> <a id="2066" href="Reflection.AST.Abstraction.html#836" class="Generalizable">A</a> <a id="2068" class="Symbol">→</a> <a id="2070" href="Relation.Binary.Definitions.html#6222" class="Function">DecidableEquality</a> <a id="2088" class="Symbol">(</a><a id="2089" href="Agda.Builtin.Reflection.html#3926" class="Datatype">Abs</a> <a id="2093" href="Reflection.AST.Abstraction.html#836" class="Generalizable">A</a><a id="2094" class="Symbol">)</a>
<a id="2096" href="Reflection.AST.Abstraction.html#2040" class="Function">≡-dec</a> <a id="2102" href="Reflection.AST.Abstraction.html#2102" class="Bound Operator">_≟_</a> <a id="2106" href="Reflection.AST.Abstraction.html#2106" class="Bound">x</a> <a id="2108" href="Reflection.AST.Abstraction.html#2108" class="Bound">y</a> <a id="2110" class="Symbol">=</a> <a id="2112" href="Reflection.AST.Abstraction.html#1841" class="Function">unAbs-dec</a> <a id="2122" class="Symbol">(</a><a id="2123" href="Reflection.AST.Abstraction.html#1802" class="Function">unAbs</a> <a id="2129" href="Reflection.AST.Abstraction.html#2106" class="Bound">x</a> <a id="2131" href="Reflection.AST.Abstraction.html#2102" class="Bound Operator">≟</a> <a id="2133" href="Reflection.AST.Abstraction.html#1802" class="Function">unAbs</a> <a id="2139" href="Reflection.AST.Abstraction.html#2108" class="Bound">y</a><a id="2140" class="Symbol">)</a>
</pre></body></html>